<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å½¢å£°å­—æ±‰å­—å­¦ä¹  - æ±‰è¯­å›½é™…æ•™è‚²</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: "Microsoft YaHei", "PingFang SC", sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #e8f4f8, #d1e7fa);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(45deg, #1a73e8, #4285f4);
            color: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(26, 115, 232, 0.3);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .stats-container {
            display: flex;
            justify-content: space-around;
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 30px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        }
        
        .stat-box {
            text-align: center;
            padding: 10px;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #1a73e8;
        }
        
        .stat-label {
            font-size: 0.95rem;
            color: #5f6368;
        }
        
        .game-area {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        .question {
            text-align: center;
            font-size: 1.8rem;
            margin-bottom: 30px;
            color: #1a4480;
            font-weight: bold;
        }
        
        .question-text {
            margin-bottom: 10px;
        }
        
        .components-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .component {
            width: 95px;
            height: 95px;
            background: linear-gradient(135deg, #f1f8fe, #e3f0ff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
            user-select: none;
            border: 2px solid #d1e0f7;
        }
        
        .component:hover {
            transform: translateY(-7px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
            background: linear-gradient(135deg, #e3f0ff, #d1e7fa);
        }
        
        .component.selected {
            transform: scale(0.95);
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
            border: 2px solid #1a73e8;
            background: #e8f0fe;
        }
        
        .equation-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .equation {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            font-size: 2.5rem;
            min-height: 150px;
        }
        
        .equation-part {
            min-width: 95px;
            min-height: 95px;
            background: #f8f9fa;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            padding: 10px;
            text-align: center;
        }
        
        .operator {
            color: #fa7b17;
            font-weight: bold;
            padding: 0 10px;
        }
        
        .target-part {
            background: #f8f9fa;
            border: 3px dashed #d1e0f7;
            min-width: 95px;
            min-height: 95px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .target-part.filled {
            background: #e8f5e9;
            border: 3px solid #34a853;
            color: #1a4480;
        }
        
        .actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 14px 30px;
            font-size: 1.15rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #1a73e8, #4285f4);
            color: white;
            box-shadow: 0 5px 12px rgba(26, 115, 232, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #fa7b17, #fbbc05);
            color: white;
            box-shadow: 0 5px 12px rgba(250, 123, 23, 0.4);
        }
        
        .btn-check {
            background: linear-gradient(45deg, #34a853, #0f9d58);
            color: white;
            box-shadow: 0 5px 12px rgba(52, 168, 83, 0.4);
            font-size: 1.25rem;
            padding: 16px 45px;
        }
        
        .btn:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.25);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .feedback {
            text-align: center;
            margin-top: 20px;
            font-size: 1.4rem;
            font-weight: bold;
            min-height: 40px;
            padding: 15px;
            border-radius: 8px;
        }
        
        .correct {
            background-color: #e8f5e9;
            color: #0f9d58;
            border: 2px solid #34a853;
        }
        
        .incorrect {
            background-color: #fce8e6;
            color: #ea4335;
            border: 2px solid #ea4335;
        }
        
        .instructions {
            background: #fff5e6;
            border-left: 5px solid #fa7b17;
            padding: 20px;
            margin: 30px 0;
            border-radius: 0 12px 12px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .instructions h3 {
            color: #fa7b17;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .explanation {
            background: #e8f5e9;
            padding: 25px;
            margin: 30px 0;
            border-radius: 15px;
            font-size: 1.1rem;
            line-height: 1.8;
            border-left: 5px solid #34a853;
            display: none;
        }
        
        .explanation.show {
            display: block;
        }
        
        .explanation h3 {
            color: #0f9d58;
            margin-bottom: 15px;
        }
        
        .classification {
            display: flex;
            margin-top: 10px;
            gap: 10px;
        }
        
        .character-type {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .pictophonetic {
            background: #f3e5f5;
            color: #9c27b0;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            color: #5f6368;
            font-size: 0.95rem;
            padding: 20px;
        }
        
        .progress-container {
            height: 8px;
            background: #e8eaed;
            border-radius: 4px;
            margin: 20px 0;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #34a853, #4285f4);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .difficulty {
            display: inline-block;
            padding: 5px 15px;
            background: #e3f0ff;
            border-radius: 50px;
            font-size: 0.9rem;
            color: #1a73e8;
            font-weight: bold;
            margin-left: 10px;
        }
        
        @media (max-width: 768px) {
            .equation {
                font-size: 2rem;
            }
            
            .component, .equation-part, .target-part {
                width: 85px;
                height: 85px;
                font-size: 2.2rem;
            }
            
            .question {
                font-size: 1.5rem;
            }
            
            .btn {
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .btn-check {
                padding: 14px 35px;
            }
        }
        
        @media (max-width: 480px) {
            .equation {
                font-size: 1.8rem;
            }
            
            .component, .equation-part, .target-part {
                width: 75px;
                height: 75px;
                font-size: 1.8rem;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .stats-container {
                padding: 10px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>å½¢å£°å­—æ±‰å­—å­¦ä¹ </h1>
            <p class="subtitle">é€šè¿‡å½¢æ—å’Œå£°æ—ç»„åˆå­¦ä¹ æ±‰å­—ç»“æ„ Â· æ±‰è¯­å›½é™…æ•™è‚²äº’åŠ¨è¯¾ä»¶</p>
        </header>
        
        <div class="stats-container">
            <div class="stat-box">
                <div class="stat-value" id="accuracy">0%</div>
                <div class="stat-label">ç­”é¢˜æ­£ç¡®ç‡</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="completed">0</div>
                <div class="stat-label">å·²å®Œæˆé¢˜ç›®</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="progress">1/6</div>
                <div class="stat-label">å½“å‰è¿›åº¦</div>
            </div>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar" style="width: 17%"></div>
        </div>
        
        <div class="instructions">
            <h3>ğŸ“ å­¦ä¹ è¯´æ˜</h3>
            <p>å½¢å£°å­—ç”±å½¢æ—ï¼ˆè¡¨ç¤ºæ„ä¹‰ç±»åˆ«çš„éƒ¨é¦–ï¼‰å’Œå£°æ—ï¼ˆè¡¨ç¤ºå‘éŸ³çš„éƒ¨åˆ†ï¼‰ç»„æˆã€‚è¯·ä»å·¦ä¾§é€‰æ‹©æ­£ç¡®çš„å£°æ—ï¼Œå¡«å……åˆ°æ–¹ç¨‹ä¸­çš„æ­£ç¡®ä½ç½®ã€‚</p>
            <p><strong>å½¢æ—</strong>è¡¨ç¤ºæ„ä¹‰ï¼ˆå¦‚æ°´ã€æœ¨ã€äººç­‰ï¼‰ Â· <strong>å£°æ—</strong>è¡¨ç¤ºå‘éŸ³ï¼ˆå¦‚èƒ¡ã€å¯ã€é‡‡ç­‰ï¼‰</p>
        </div>
        
        <div class="game-area">
            <div class="question">
                <div class="question-text" id="question-text">è¯·ç»„åˆå‡ºè¡¨ç¤º"æµæ°´é€šé“"çš„æ±‰å­—</div>
                <div><span id="character-type" class="character-type pictophonetic">å½¢å£°å­—</span> <span class="difficulty">éš¾åº¦: â˜…â˜…â˜†</span></div>
            </div>
            
            <div class="components-container" id="components-container">
                <!-- ç»„ä»¶ä¼šåŠ¨æ€ç”Ÿæˆ -->
            </div>
            
            <div class="equation-container">
                <div class="equation" id="equation">
                    <!-- æ–¹ç¨‹å¼ä¼šåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div class="equation">
                    <div class="equation-part">å½¢æ—ï¼ˆæ„ä¹‰ï¼‰</div>
                    <div class="operator">+</div>
                    <div class="equation-part">å£°æ—ï¼ˆå‘éŸ³ï¼‰</div>
                    <div class="operator">=</div>
                    <div class="equation-part">å½¢å£°å­—</div>
                </div>
            </div>
            
            <div class="actions">
                <button class="btn btn-primary" id="prev-btn">ä¸Šä¸€é¢˜</button>
                <button class="btn btn-check" id="check-btn">æ£€æŸ¥ç­”æ¡ˆ</button>
                <button class="btn btn-secondary" id="next-btn">ä¸‹ä¸€é¢˜</button>
            </div>
            
            <div class="feedback" id="feedback">è¯·é€‰æ‹©å·¦ä¾§çš„å£°æ—å¡«å……åˆ°å³ä¾§ç©ºä½ä¸­</div>
        </div>
        
        <div class="explanation" id="explanation">
            <!-- è§£é‡Šå†…å®¹ä¼šåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <footer>
            <p>æ±‰è¯­å›½é™…æ•™è‚²æ±‰å­—å­¦ä¹ ç³»ç»Ÿ Â© 2023 | å¯åœ¨æ‰‹æœºã€å¹³æ¿ã€ç”µè„‘æµè§ˆå™¨ä¸­ä½¿ç”¨</p>
            <p>æ— éœ€å®‰è£…è½¯ä»¶Â·æ”¯æŒè§¦æ‘¸å±å’Œé¼ æ ‡æ“ä½œÂ·å“åº”å¼è®¾è®¡é€‚é…æ‰€æœ‰è®¾å¤‡</p>
        </footer>
    </div>

    <script>
        // å½¢å£°å­—æ•°æ®ç»“æ„ï¼ˆå…¨éƒ¨ç¬¦åˆä¼ ç»Ÿæ±‰å­—é‡Šä¹‰ï¼‰
        const charactersData = [
            {
                id: 1,
                type: "å½¢å£°å­—",
                hint: "æµæ°´é€šé“",
                answer: "æ²³",
                components: ["æ°µ", "å¯"],
                distractors: ["æ¹–", "ä½•", "å‘µ"],
                explanation: "ã€æ²³ã€æ˜¯å½¢å£°å­—ã€‚å½¢æ—ã€æ°µã€ï¼ˆæ°´ï¼‰è¡¨ç¤ºä¸æ°´æœ‰å…³ï¼Œå£°æ—ã€å¯ã€è¡¨ç¤ºå‘éŸ³ã€‚ä¼ ç»Ÿé‡Šä¹‰æŒ‡å¤©ç„¶æˆ–äººå·¥çš„æ°´é“ã€‚",
                meaning: "è‡ªç„¶æˆ–äººå·¥çš„æ°´é“ï¼Œæµæ°´é€šé“",
                composition: "å½¢æ—ï¼ˆæ„ä¹‰ï¼‰: æ°µï¼ˆæ°´ï¼‰<br>å£°æ—ï¼ˆå‘éŸ³ï¼‰: å¯"
            },
            {
                id: 2,
                type: "å½¢å£°å­—",
                hint: "é£Ÿç”¨æ¤ç‰©",
                answer: "èœ",
                components: ["è‰¹", "é‡‡"],
                distractors: ["å½©", "è¸©", "é‡‡"],
                explanation: "ã€èœã€æ˜¯å½¢å£°å­—ã€‚å½¢æ—ã€è‰¹ã€ï¼ˆè‰å­—å¤´ï¼‰è¡¨ç¤ºæ¤ç‰©ï¼Œå£°æ—ã€é‡‡ã€è¡¨ç¤ºå‘éŸ³ã€‚ä¼ ç»Ÿé‡Šä¹‰æŒ‡å¯åšå‰¯é£Ÿå“çš„æ¤ç‰©ã€‚",
                meaning: "å¯åšå‰¯é£Ÿå“çš„æ¤ç‰©ï¼Œè”¬èœ",
                composition: "å½¢æ—ï¼ˆæ„ä¹‰ï¼‰: è‰¹ï¼ˆæ¤ç‰©ï¼‰<br>å£°æ—ï¼ˆå‘éŸ³ï¼‰: é‡‡"
            },
            {
                id: 3,
                type: "å½¢å£°å­—",
                hint: "å¥³æ€§é•¿è¾ˆ",
                answer: "å§‘",
                components: ["å¥³", "å¤"],
                distractors: ["æ•…", "å’•", "è¾œ"],
                explanation: "ã€å§‘ã€æ˜¯å½¢å£°å­—ã€‚å½¢æ—ã€å¥³ã€è¡¨ç¤ºæ€§åˆ«ï¼Œå£°æ—ã€å¤ã€è¡¨ç¤ºå‘éŸ³ã€‚ä¼ ç»Ÿé‡Šä¹‰æŒ‡çˆ¶äº²çš„å§å¦¹æˆ–ä¸ˆå¤«çš„æ¯äº²ã€‚",
                meaning: "ä¸ˆå¤«çš„æ¯äº²ï¼Œçˆ¶äº²çš„å§å¦¹",
                composition: "å½¢æ—ï¼ˆæ„ä¹‰ï¼‰: å¥³ï¼ˆå¥³æ€§ï¼‰<br>å£°æ—ï¼ˆå‘éŸ³ï¼‰: å¤"
            },
            {
                id: 4,
                type: "å½¢å£°å­—",
                hint: "è¢«é™†åœ°åŒ…å›´çš„å¤§ç‰‡æ°´åŸŸï¼Œé¢ç§¯å°äºæµ·",
                answer: "æ¹–",
                components: ["æ°µ", "èƒ¡"],
                distractors: ["ç³Š", "ç‘š", "è‘«"],
                explanation: "ã€æ¹–ã€æ˜¯å½¢å£°å­—ã€‚å½¢æ—ã€æ°µã€ï¼ˆæ°´ï¼‰è¡¨ç¤ºä¸æ°´æœ‰å…³ï¼Œå£°æ—ã€èƒ¡ã€è¡¨ç¤ºå‘éŸ³ã€‚ä¼ ç»Ÿé‡Šä¹‰æŒ‡è¢«é™†åœ°åŒ…å›´çš„å¤§ç‰‡æ°´åŸŸã€‚",
                meaning: "è¢«é™†åœ°åŒ…å›´çš„å¤§ç‰‡æ°´åŸŸ",
                composition: "å½¢æ—ï¼ˆæ„ä¹‰ï¼‰: æ°µï¼ˆæ°´ï¼‰<br>å£°æ—ï¼ˆå‘éŸ³ï¼‰: èƒ¡"
            },
            {
                id: 5,
                type: "å½¢å£°å­—",
                hint: "ç‰çš„é›•ç¢",
                answer: "ç†",
                components: ["ç‹", "é‡Œ"],
                distractors: ["ç‹¸", "å˜", "é²¤"],
                explanation: "ã€ç†ã€æ˜¯å½¢å£°å­—ã€‚å½¢æ—ã€ç‹ã€ï¼ˆç‰ï¼‰è¡¨ç¤ºç‰çŸ³ï¼Œå£°æ—ã€é‡Œã€è¡¨ç¤ºå‘éŸ³ã€‚ä¼ ç»Ÿé‡Šä¹‰æŒ‡é›•ç¢åŠ å·¥ç‰çŸ³ï¼Œå¼•ç”³ä¸ºæ²»ç†ã€æ•´ç†ã€‚",
                meaning: "é›•ç¢ç‰çŸ³ï¼Œæ²»ç†ï¼Œæ•´ç†",
                composition: "å½¢æ—ï¼ˆæ„ä¹‰ï¼‰: ç‹ï¼ˆç‰ï¼‰<br>å£°æ—ï¼ˆå‘éŸ³ï¼‰: é‡Œ"
            },
            {
                id: 6,
                type: "å½¢å£°å­—",
                hint: "æ˜†è™«ç§ç±»",
                answer: "è´",
                components: ["è™«", "èƒ¡"],
                distractors: ["æ¹–", "ç³Š", "ç‘š"],
                explanation: "ã€è´ã€æ˜¯å½¢å£°å­—ã€‚å½¢æ—ã€è™«ã€è¡¨ç¤ºæ˜†è™«ï¼Œå£°æ—ã€èƒ¡ã€è¡¨ç¤ºå‘éŸ³ã€‚ä¼ ç»Ÿé‡Šä¹‰æŒ‡ä¸€ç§èƒ½é£ä¸”å¸¸ä¸èŠ±æœµä¼´ç”Ÿçš„æ˜†è™«ã€‚",
                meaning: "ä¸€ç§æœ‰ç¿…è†€ã€å¸èŠ±èœœçš„æ˜†è™«",
                composition: "å½¢æ—ï¼ˆæ„ä¹‰ï¼‰: è™«ï¼ˆæ˜†è™«ï¼‰<br>å£°æ—ï¼ˆå‘éŸ³ï¼‰: èƒ¡"
            }
        ];
        
        // å½“å‰é¢˜ç›®ç´¢å¼•
        let currentQuestionIndex = 0;
        let score = {
            total: 0,
            correct: 0,
            attempted: 0
        };
        let selectedComponent = null;
        let targetSlot = null;
        
        // DOMå…ƒç´ 
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const checkBtn = document.getElementById('check-btn');
        const feedbackEl = document.getElementById('feedback');
        const componentsContainer = document.getElementById('components-container');
        const equationDisplay = document.getElementById('equation');
        const accuracyEl = document.getElementById('accuracy');
        const completedEl = document.getElementById('completed');
        const progressEl = document.getElementById('progress');
        const progressBar = document.getElementById('progress-bar');
        const explanationEl = document.getElementById('explanation');
        const questionText = document.getElementById('question-text');
        const characterType = document.getElementById('character-type');
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            loadQuestion(currentQuestionIndex);
            updateStats();
        }
        
        // åŠ è½½é¢˜ç›®
        function loadQuestion(index) {
            const question = charactersData[index];
            selectedComponent = null;
            targetSlot = null;
            
            // é‡ç½®çŠ¶æ€
            feedbackEl.textContent = "è¯·é€‰æ‹©å·¦ä¾§çš„å£°æ—å¡«å……åˆ°å³ä¾§ç©ºä½ä¸­";
            feedbackEl.className = "feedback";
            explanationEl.classList.remove("show");
            
            // æ›´æ–°é¢˜ç›®
            questionText.textContent = `è¯·ç»„åˆå‡ºè¡¨ç¤º"${question.hint}"çš„æ±‰å­—`;
            characterType.textContent = question.type;
            progressEl.textContent = `${index + 1}/${charactersData.length}`;
            
            // æ¸…é™¤ç°æœ‰ç»„ä»¶
            componentsContainer.innerHTML = '';
            equationDisplay.innerHTML = '';
            
            // æ·»åŠ ç»„ä»¶ï¼ˆç¡®ä¿æ­£ç¡®ç­”æ¡ˆåŒ…å«åœ¨é€‰é¡¹ä¸­ï¼‰
            let allComponents = [...question.distractors];
            
            // éšæœºæ’åº
            shuffleArray(allComponents);
            
            // æ·»åŠ å£°æ—å…ƒç´ ï¼ˆæœ€å¤š4ä¸ªï¼Œç¡®ä¿æ­£ç¡®ç­”æ¡ˆå­˜åœ¨ï¼‰
            allComponents.slice(0, 3).forEach(comp => {
                if(comp !== question.components[1]) {
                    addComponent(comp);
                }
            });
            // ç¡®ä¿æ­£ç¡®ç­”æ¡ˆå­˜åœ¨
            addComponent(question.components[1]);
            
            // æ·»åŠ æ–¹ç¨‹
            const formPart = document.createElement('div');
            formPart.className = 'equation-part';
            formPart.textContent = question.components[0]; // å½¢æ—
            equationDisplay.appendChild(formPart);
            
            const plus = document.createElement('div');
            plus.className = 'operator';
            plus.textContent = '+';
            equationDisplay.appendChild(plus);
            
            const target = document.createElement('div');
            target.className = 'target-part';
            target.id = 'target-slot';
            target.innerHTML = "";
            equationDisplay.appendChild(target);
            targetSlot = target;
            
            const equals = document.createElement('div');
            equals.className = 'operator';
            equals.textContent = '=';
            equationDisplay.appendChild(equals);
            
            const result = document.createElement('div');
            result.className = 'equation-part';
            result.textContent = '?';
            result.id = 'result-display';
            equationDisplay.appendChild(result);
            
            // æ›´æ–°è¿›åº¦æ¡
            const progressPercent = Math.round((index + 1) / charactersData.length * 100);
            progressBar.style.width = `${progressPercent}%`;
        }
        
        function addComponent(comp) {
            const compEl = document.createElement('div');
            compEl.className = 'component';
            compEl.dataset.component = comp;
            compEl.textContent = comp;
            compEl.addEventListener('click', () => {
                // ç§»é™¤ä¹‹å‰é€‰ä¸­çš„æ ·å¼
                document.querySelectorAll('.component.selected').forEach(el => el.classList.remove('selected'));
                // æ·»åŠ é€‰ä¸­æ ·å¼
                compEl.classList.add('selected');
                selectedComponent = comp;
                feedbackEl.textContent = `å·²é€‰ä¸­ï¼š${comp}ï¼Œè¯·ç‚¹å‡»å³ä¾§ç©ºç™½ä½ç½®`;
            });
            componentsContainer.appendChild(compEl);
        }
        
        // ç›®æ ‡ä½ç½®ç‚¹å‡»äº‹ä»¶å§”æ‰˜
        document.addEventListener('click', function(e) {
            if(e.target && e.target.id === 'target-slot' && selectedComponent) {
                e.target.textContent = selectedComponent;
                e.target.classList.add('filled');
                feedbackEl.textContent = `å·²æ”¾ç½®ï¼š${selectedComponent}`;
                
                // æ¸…é™¤é€‰æ‹©
                document.querySelectorAll('.component.selected').forEach(el => el.classList.remove('selected'));
                selectedComponent = null;
            }
        });
        
        // æ£€æŸ¥ç­”æ¡ˆ
        function checkAnswer() {
            const question = charactersData[currentQuestionIndex];
            
            // æ£€æŸ¥æ˜¯å¦å·²ç»é€‰æ‹©
            if (!targetSlot || !targetSlot.textContent) {
                feedbackEl.textContent = "è¯·å…ˆé€‰æ‹©å¹¶æ”¾ç½®ä¸€ä¸ªå£°æ—";
                feedbackEl.className = "feedback incorrect";
                return;
            }
            
            score.attempted++;
            score.total++;
            
            if (targetSlot.textContent === question.components[1]) {
                feedbackEl.textContent = `æ­£ç¡®ï¼æ‚¨æˆåŠŸç»„åˆå‡ºäº†æ±‰å­—ï¼š${question.answer}`;
                feedbackEl.className = "feedback correct";
                score.correct++;
                
                // æ˜¾ç¤ºæ­£ç¡®ç­”æ¡ˆ
                document.getElementById('result-display').textContent = question.answer;
                document.getElementById('result-display').style.color = "#1a73e8";
                document.getElementById('result-display').style.fontWeight = "bold";
                
                // æ˜¾ç¤ºè§£é‡Š
                explanationEl.innerHTML = `
                    <h3>ğŸ“š æ±‰å­—çŸ¥è¯†ï¼š${question.answer}ï¼ˆ${question.type}ï¼‰</h3>
                    <p>${question.explanation}</p>
                    <p><strong>ä¼ ç»Ÿé‡Šä¹‰ï¼š</strong>${question.meaning}</p>
                    <p><strong>ç»“æ„ç»„æˆï¼š</strong><br>${question.composition}</p>
                `;
                explanationEl.classList.add("show");
            } else {
                feedbackEl.textContent = `ç»„åˆæœ‰è¯¯ï¼å°è¯•é€‰æ‹©å…¶ä»–å£°æ—`;
                feedbackEl.className = "feedback incorrect";
                
                // é‡ç½®ç›®æ ‡æ§½
                targetSlot.textContent = "";
                targetSlot.classList.remove('filled');
            }
            
            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            updateStats();
        }
        
        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStats() {
            const accuracy = score.total > 0 ? Math.round((score.correct / score.total) * 100) : 0;
            accuracyEl.textContent = `${accuracy}%`;
            completedEl.textContent = score.total;
        }
        
        // ä¸‹ä¸€é¢˜
        function nextQuestion() {
            if (currentQuestionIndex < charactersData.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            } else {
                feedbackEl.textContent = "æ­å–œï¼æ‚¨å·²å®Œæˆæ‰€æœ‰é¢˜ç›®";
                feedbackEl.className = "feedback correct";
            }
        }
        
        // ä¸Šä¸€é¢˜
        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            } else {
                feedbackEl.textContent = "å·²ç»æ˜¯ç¬¬ä¸€é¢˜äº†ï¼";
                feedbackEl.className = "feedback incorrect";
            }
        }
        
        // è¾…åŠ©å‡½æ•°ï¼šæ•°ç»„éšæœºæ’åº
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        // äº‹ä»¶ç›‘å¬
        checkBtn.addEventListener('click', checkAnswer);
        nextBtn.addEventListener('click', nextQuestion);
        prevBtn.addEventListener('click', prevQuestion);
        
        // å¯åŠ¨æ¸¸æˆ
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>