<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>国际中文教育辅助学习助手 1.0 · 首页</title>
  <meta name="description" content="国际中文教育辅助学习助手 1.0：面向国际中文教育的多模块学习工具集合，支持移动优先、可访问性与本地化。">
  <meta name="theme-color" content="#0b0e13" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="实用 有趣 大语言模型 · 首页">
  <meta property="og:description" content="点击卡片进入：多音字、形声字、听写、汉字奥秘、词汇等级分析、趣味闯关与点词成句。">
  <meta property="og:image" content="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1200' height='630'%3E%3Crect width='100%25' height='100%25' fill='%2311161d'/%3E%3Ctext x='50%25' y='52%25' fill='%23e9edf2' font-size='44' text-anchor='middle' font-family='Arial,sans-serif'%3E国际中文教育辅助学习助手 1.0%3C/text%3E%3C/svg%3E">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='46' fill='%234f46e5'/%3E%3Ctext x='50' y='60' text-anchor='middle' font-size='54' fill='white' font-family='Arial, Helvetica, sans-serif'%3ECN%3C/text%3E%3C/svg%3E">
  <style>
    /* ---------- Design Tokens ---------- */
    :root{
      --bg: #0b0e13;
      --surface: #11161d;
      --text: #e9edf2;
      --muted: #9aa4b2;
      --line: rgba(255,255,255,.12);
      --brand: #4f46e5;   /* indigo */
      --brand-2: #06b6d4; /* cyan   */
      --radius: 18px;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
      --glass: rgba(255,255,255,.06);
      --gap: clamp(14px, 2vw, 22px);
    }
    [data-theme="light"]{
      --bg: #f6f7fb;
      --surface:#ffffff;
      --text: #0b0f14;
      --muted:#556171;
      --line: rgba(0,0,0,.12);
      --shadow: 0 8px 20px rgba(21,21,21,.08);
      --glass: rgba(0,0,0,.04);
    }
    @media (prefers-reduced-motion: reduce){
      *{animation:none!important;transition:none!important}
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Helvetica Neue", Arial, "Noto Sans SC", "Microsoft YaHei", sans-serif;
      background:
        radial-gradient(1200px 800px at 10% -10%, color-mix(in oklab, var(--brand) 35%, transparent), transparent 60%),
        radial-gradient(900px 600px at 110% 10%, color-mix(in oklab, var(--brand-2) 30%, transparent), transparent 60%),
        var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    a{color:inherit;text-decoration:none}
    .container{max-width:1200px;margin:0 auto;padding:clamp(16px,3vw,28px);}

    /* ---------- A11y: Skip to content & focus ---------- */
    .skip-link{position:absolute;left:-9999px;top:auto;overflow:hidden}
    .skip-link:focus{left:16px;top:16px;z-index:1000;background:#fff;color:#111;padding:.6rem 1rem;border-radius:10px;box-shadow:0 4px 16px rgba(0,0,0,.15)}
    :focus-visible{outline:2px solid color-mix(in oklab, var(--brand) 60%, white 40%); outline-offset:3px; border-radius:12px}

    /* ---------- Header ---------- */
    .header{display:flex;align-items:center;justify-content:space-between;gap:14px;padding:14px 0}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:40px;height:40px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand-2));box-shadow:var(--shadow);display:grid;place-items:center;color:white;font-weight:800;letter-spacing:.5px}
    .title-wrap h1{font-size:clamp(20px,3vw,28px);line-height:1.1;margin:0}
    .title-wrap p{margin:.25rem 0 0;color:var(--muted);font-size:.95rem}
    .actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .btn{padding:10px 14px;border-radius:12px;border:1px solid transparent;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:white;font-weight:600;letter-spacing:.3px;box-shadow:var(--shadow);transition:transform .15s ease, filter .2s ease}
    .btn:hover{transform:translateY(-1px);filter:brightness(1.05)}
    .btn.secondary{background:transparent;color:var(--text);border:1px solid var(--line);backdrop-filter:blur(6px);background-color:var(--glass)}
    .icon-btn{display:inline-flex;align-items:center;gap:8px}

    /* ---------- Hero ---------- */
    .hero{margin-top:10px;border-radius:var(--radius);padding:clamp(20px,3.5vw,36px);background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid var(--line);box-shadow:var(--shadow)}
    .hero h2{font-size:clamp(22px,3.5vw,34px);margin:0 0 10px;letter-spacing:.3px}
    .hero p{margin:8px 0 0;color:var(--muted);max-width:72ch}
    .hero .quick{margin-top:14px;display:flex;gap:8px;flex-wrap:wrap}
    .chip{padding:8px 12px;border-radius:999px;background:var(--glass);border:1px solid var(--line);color:var(--muted);font-size:.9rem}

    /* ---------- Controls ---------- */
    .controls{margin-top:16px;display:flex;gap:10px;flex-wrap:wrap}
    .input, .select{
      display:inline-flex;align-items:center;gap:8px;
      background:var(--surface);border:1px solid var(--line);color:var(--text);
      padding:10px 12px;border-radius:12px;box-shadow:var(--shadow)
    }
    .input input{all:unset;width:220px}
    .select select{all:unset}
    .tip{color:var(--muted);font-size:.9rem}

    /* ---------- Grid ---------- */
    .grid{display:grid;grid-template-columns:repeat(auto-fill, minmax(240px,1fr));gap:var(--gap);margin-top:clamp(18px,3vw,26px)}
    .card{position:relative;overflow:hidden;border-radius:var(--radius);background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.03));border:1px solid var(--line);box-shadow:var(--shadow);transition:transform .18s ease, border-color .2s ease}
    .card:hover{transform:translateY(-4px);border-color:color-mix(in oklab, var(--brand) 45%, var(--line))}
    .card header{display:flex;align-items:center;gap:12px;padding:18px}
    .card .svg{width:42px;height:42px;border-radius:12px;display:grid;place-items:center;color:white;background:linear-gradient(135deg,var(--brand),var(--brand-2));box-shadow:inset 0 0 0 1px rgba(255,255,255,.25)}
    .card .name{font-weight:800;font-size:1.05rem}
    .card .desc{color:var(--muted);font-size:.92rem;padding:0 18px 10px;min-height:56px}
    .meta{display:flex;gap:10px;align-items:center;color:var(--muted);padding:0 18px 12px;font-size:.85rem;flex-wrap:wrap}
    .tag{padding:.15rem .5rem;border:1px solid var(--line);border-radius:999px}
    .divider{height:1px;background:var(--line);margin:0 18px 12px}
    .go{display:flex;align-items:center;justify-content:space-between;gap:10px;padding: 0 18px 16px 18px}
    .cta{display:inline-flex;align-items:center;gap:8px;font-weight:700;color:white;background:linear-gradient(135deg,var(--brand),var(--brand-2));padding:9px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.14)}
    .hint{color:var(--muted);font-size:.9rem}

    /* ---------- Footer ---------- */
    footer{margin: 28px 0 14px;color:var(--muted);font-size:.9rem;text-align:center}

    /* ---------- Utilities ---------- */
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}
  </style>
</head>
<body>
  <a class="skip-link" href="#modules">跳到模块列表</a>
  <div class="container">
    <!-- Header -->
    <header class="header" aria-label="站点标题与操作">
      <div class="brand">
        <div class="logo" aria-hidden="true">中</div>
        <div class="title-wrap">
          <h1 id="heroTitle">国际中文教育辅助学习助手 <span style="opacity:.7;font-weight:600">1.0</span></h1>
          <p>面向课堂与自学的轻量化工具集：听写、词汇、组句、汉字知识与趣味游戏，一站式进入。</p>
        </div>
      </div>
      <div class="actions">
        <button class="btn icon-btn" id="browseAll" aria-label="浏览全部模块">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 5v14m-7-7h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          浏览全部模块
        </button>
        <button class="btn secondary icon-btn" id="themeToggle" aria-label="切换主题（亮/暗）">
          <svg id="themeIcon" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 3a9 9 0 1 0 9 9 7 7 0 0 1-9-9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          主题
        </button>
        <button class="btn secondary icon-btn" id="langToggle" aria-label="切换语言">EN</button>
      </div>
    </header>

    <!-- Hero -->
    <section class="hero" id="hero">
      <h2 id="heroSubtitle">实用 有趣 大语言模型</h2>
      <p id="heroDesc">服务全球中文学习与教学，涵盖字词学习、语用训练与文化拓展，助力 HSK、HSKK 与 IB 中文课程的课堂与自主学习。</p>
      <div class="quick" aria-label="快速标签">
        <span class="chip" data-i18n="chip1">A1–C2 适配</span>
        <span class="chip" data-i18n="chip2">移动优先</span>
        <span class="chip" data-i18n="chip3">无跟踪</span>
        <span class="chip" data-i18n="chip4">课程集成</span>
      </div>
      <div class="controls" role="group" aria-label="筛选与搜索">
        <label class="input" for="q">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/><path d="M21 21l-3.5-3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          <input id="q" placeholder="搜索模块…" aria-label="搜索模块">
        </label>
        <label class="select" for="filter">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 6h16M7 12h10m-6 6h2" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          <select id="filter" aria-label="模块类型筛选">
            <option value="all">全部类型</option>
            <option value="study">学习</option>
            <option value="game">游戏</option>
            <option value="tool">工具</option>
          </select>
        </label>
        <span class="tip" id="resultCount" aria-live="polite"></span>
      </div>
    </section>

    <!-- Modules Grid -->
    <section id="modules" class="grid" aria-label="模块列表" role="list">
      <!-- Card Template Note: update data-* for filter/search -->
      <a href="1多音字学习.html" class="card" role="listitem" data-card data-type="study" data-title="多音字学习" data-desc="常见读音与义项, 中英双语例词">
        <header>
          <div class="svg" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M5 12h14M12 5v14" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="name">多音字学习</div>
        </header>
        <p class="desc">按字符聚合常见读音与义项，中英双语例词辅助辨义。</p>
        <div class="meta"><span class="tag">学习</span><span class="tag">A2–B2</span><span class="tag">≈10–15分钟</span></div>
        <div class="divider" aria-hidden="true"></div>
        <div class="go"><span class="hint">进入模块</span><span class="cta">打开</span></div>
      </a>

      <a href="2形声字学习.html" class="card" role="listitem" data-card data-type="study" data-title="形声字学习" data-desc="形旁 声旁 构形逻辑 部件组合">
        <header>
          <div class="svg" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <circle cx="12" cy="12" r="9" stroke="white" stroke-width="2"/>
            </svg>
          </div>
          <div class="name">形声字学习</div>
        </header>
        <p class="desc">部件选择与组合练习，理解形旁与声旁的构形逻辑。</p>
        <div class="meta"><span class="tag">学习</span><span class="tag">A2–B1</span><span class="tag">≈8–12分钟</span></div>
        <div class="divider"></div>
        <div class="go"><span class="hint">进入模块</span><span class="cta">打开</span></div>
      </a>

      <a href="3汉字听写游戏.html" class="card" role="listitem" data-card data-type="game" data-title="汉字听写游戏" data-desc="按读音写字 词义提示 多难度 键盘 触屏">
        <header>
          <div class="svg" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M4 12h3l3-8 3 16 3-8h4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="name">汉字听写游戏</div>
        </header>
        <p class="desc">按读音写字与词义提示，多难度自适应，支持键盘/触屏。</p>
        <div class="meta"><span class="tag">游戏</span><span class="tag">A1–B2</span><span class="tag">≈5–10分钟</span></div>
        <div class="divider"></div>
        <div class="go"><span class="hint">进入模块</span><span class="cta">打开</span></div>
      </a>

      <a href="4汉字奥秘.html" class="card" role="listitem" data-card data-type="study" data-title="汉字奥秘" data-desc="构形 演变 文化意涵 文字历史">
        <header>
          <div class="svg" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M12 2l3 7 7 1-5 5 1 7-6-3-6 3 1-7-5-5 7-1 3-7z" stroke="white" stroke-width="2" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="name">汉字奥秘</div>
        </header>
        <p class="desc">从构形、演变与文化意涵视角，探索文字背后的故事。</p>
        <div class="meta"><span class="tag">学习</span><span class="tag">A2–C1</span><span class="tag">≈10–20分钟</span></div>
        <div class="divider"></div>
        <div class="go"><span class="hint">进入模块</span><span class="cta">打开</span></div>
      </a>

      <a href="5汉语词汇等级分析.html" class="card" role="listitem" data-card data-type="tool" data-title="汉语词汇等级分析" data-desc="输入词汇 自动判级 示例 分层教学 备课">
        <header>
          <div class="svg" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M4 18V6m6 12V9m6 9V4" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="name">汉语词汇等级分析</div>
        </header>
        <p class="desc">输入词汇自动判级并给出示例，用于分层教学与备课。</p>
        <div class="meta"><span class="tag">工具</span><span class="tag">A2–C2</span><span class="tag">≈3–8分钟</span></div>
        <div class="divider"></div>
        <div class="go"><span class="hint">进入模块</span><span class="cta">打开</span></div>
      </a>

      <a href="6贪吃词语挑战.html" class="card" role="listitem" data-card data-type="game" data-title="贪吃词语挑战" data-desc="词义分类 反应速度 趣味闯关 贪吃蛇">
        <header>
          <div class="svg" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M12 3a9 9 0 1 0 9 9h-9V3z" stroke="white" stroke-width="2"/>
            </svg>
          </div>
          <div class="name">贪吃词语挑战</div>
        </header>
        <p class="desc">词义分类 + 反应速度的趣味闯关版"贪吃蛇"。</p>
        <div class="meta"><span class="tag">游戏</span><span class="tag">A1–B1</span><span class="tag">≈4–8分钟</span></div>
        <div class="divider"></div>
        <div class="go"><span class="hint">进入模块</span><span class="cta">打开</span></div>
      </a>

      <a href="7中文词汇大闯关.html" class="card" role="listitem" data-card data-type="game" data-title="中文词汇大闯关" data-desc="等级递进 选择 记忆训练 自定义词库">
        <header>
          <div class="svg" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M6 6h12v12H6z" stroke="white" stroke-width="2"/>
            </svg>
          </div>
          <div class="name">中文词汇大闯关</div>
        </header>
        <p class="desc">按等级递进的选择与记忆训练，支持自定义词库。</p>
        <div class="meta"><span class="tag">游戏</span><span class="tag">A1–B2</span><span class="tag">≈6–12分钟</span></div>
        <div class="divider"></div>
        <div class="go"><span class="hint">进入模块</span><span class="cta">打开</span></div>
      </a>

      <a href="8点词成句.html" class="card" role="listitem" data-card data-type="study" data-title="点词成句" data-desc="拖拽 点击 句子构建 语序 搭配 语法">
        <header>
          <div class="svg" aria-hidden="true">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
              <path d="M4 7h16M4 12h10M4 17h16" stroke="white" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="name">点词成句</div>
        </header>
        <p class="desc">通过拖拽/点击将词语组合为句，训练语序与搭配。</p>
        <div class="meta"><span class="tag">学习</span><span class="tag">A1–B1</span><span class="tag">≈5–10分钟</span></div>
        <div class="divider"></div>
        <div class="go"><span class="hint">进入模块</span><span class="cta">打开</span></div>
      </a>
    </section>

    <!-- Conversational Companion (DeepSeek) -->
    <section id="chat-companion" aria-label="对话式学伴" style="margin-top:22px">
      <div class="hero" style="padding:18px">
        <h2 style="margin-top:0" id="chatTitle">对话式学伴（DeepSeek 接入）</h2>
        <div class="tip" style="margin:6px 0 12px" id="chatDesc">
          角色：<b>汉语学习者</b>（HSK/HSKK/IB 中文对接）。可直接用中文或英文提问，系统将以"正在学汉语的学生"身份用简洁中文回应，并适度给出拼音/英文解释。
        </div>

        <div class="chat-panel" role="region" aria-label="对话式学伴" style="display:grid;gap:12px;margin-top:8px">
          <div id="chatMessages" class="chat-messages" aria-live="polite" style="max-height:340px;overflow:auto;border:1px solid var(--line);background:var(--surface);border-radius:14px;padding:12px;box-shadow:var(--shadow)"></div>

          <form id="chatForm" class="chat-form" autocomplete="off" style="display:flex;gap:10px;flex-wrap:wrap;align-items:flex-start">
            <label class="input" for="chatInput" style="flex:1 1 420px;min-width:220px">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 7h16M4 12h10M4 17h16" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
              <textarea id="chatInput" rows="2" placeholder="请输入你的问题，例如：请用HSK2词汇介绍你的周末……" aria-label="输入问题" style="all:unset;min-height:44px;max-height:120px;overflow:auto;white-space:pre-wrap;word-break:break-word;width:100%"></textarea>
            </label>
            <button class="btn icon-btn" id="chatSend" aria-label="发送消息" type="submit">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 12l16-8-6 8 6 8-16-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              发送
            </button>
            <button class="btn secondary icon-btn" id="chatClear" type="button" aria-label="清空对话">清空</button>
          </form>
        </div>
      </div>
    </section>

    <footer id="footer">
      © 2025 国际中文教育辅助学习助手 1.0 ·  反馈：695790187@qq.com
    </footer>
  </div>

  <script>
    // ---------- Theme init ----------
    (function initTheme(){
      const stored = localStorage.getItem('theme');
      const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
      const theme = stored || (prefersLight ? 'light' : 'dark');
      document.documentElement.setAttribute('data-theme', theme);
    })();

    // ---------- Controls ----------
    const q = document.getElementById('q');
    const filterSel = document.getElementById('filter');
    const resultCount = document.getElementById('resultCount');
    const cards = Array.from(document.querySelectorAll('[data-card]'));
    const browseAll = document.getElementById('browseAll');

    function applyFilter(){
      const kw = (q.value || '').trim().toLowerCase();
      const type = filterSel.value;
      let shown = 0;
      cards.forEach(card => {
        const hay = (card.dataset.title + ' ' + card.dataset.desc).toLowerCase();
        const okType = (type === 'all' || card.dataset.type === type);
        const visible = hay.includes(kw) && okType;
        card.style.display = visible ? '' : 'none';
        if (visible) shown++;
      });
      resultCount.textContent = shown === cards.length ? '' : `共 ${shown} 个匹配结果`;
    }
    q.addEventListener('input', applyFilter);
    filterSel.addEventListener('change', applyFilter);
    browseAll.addEventListener('click', () => { q.value=''; filterSel.value='all'; applyFilter(); document.getElementById('modules').scrollIntoView({behavior:'smooth', block:'start'}); });
    applyFilter();

    // ---------- Theme toggle ----------
    document.getElementById('themeToggle').addEventListener('click', () => {
      const root = document.documentElement;
      const isLight = root.getAttribute('data-theme') === 'light';
      const next = isLight ? 'dark' : 'light';
      root.setAttribute('data-theme', next);
      localStorage.setItem('theme', next);
    });

    // ---------- Enhanced i18n with dynamic button text ----------
    const i18n = {
      zh: {
        heroTitle: "国际中文教育辅助学习助手 1.0",
        heroSubtitle: "实用 有趣 大语言模型",
        heroDesc: "服务全球中文学习与教学，涵盖字词学习、语用训练与文化拓展，助力 HSK、HSKK 与 IB 中文课程的课堂与自主学习。",
        chips: ["A1–C2 适配","移动优先","无跟踪","课程集成"],
        go: "进入模块",
        open: "打开",
        searchPH: "搜索模块…",
        all: "全部类型", study: "学习", game: "游戏", tool: "工具",
        browse: "浏览全部模块",
        theme: "主题",
        langToggle: "EN",
        chatTitle: "对话式学伴（DeepSeek 接入）",
        chatDesc: "角色：<b>汉语学习者</b>（HSK/HSKK/IB 中文对接）。可直接用中文或英文提问，系统将以\"正在学汉语的学生\"身份用简洁中文回应，并适度给出拼音/英文解释。",
        chatPlaceholder: "请输入你的问题，例如：请用HSK2词汇介绍你的周末……",
        send: "发送",
        clear: "清空",
        footer: "© 2025 国际中文教育辅助学习助手 1.0 · 反馈：695790187@qq.com",
        resultCount: "个匹配结果"
      },
      en: {
        heroTitle: "International Chinese Education Assistant 1.0",
        heroSubtitle: "Practical, Fun, Large Language Model",
        heroDesc: "Supporting global learners and teachers in vocabulary, grammar, and culture modules—aligned with HSK, HSKK, and IB Chinese curricula for both classroom and self-directed study.",
        chips: ["A1–C2 ready","Mobile-first","No tracking","Course-ready"],
        go: "Open module",
        open: "Open",
        searchPH: "Search modules…",
        all: "All types", study: "Study", game: "Game", tool: "Tool",
        browse: "Browse all",
        theme: "Theme",
        langToggle: "中",
        chatTitle: "Conversational Companion (DeepSeek)",
        chatDesc: "Role: <b>Chinese Learner</b> (aligned with HSK/HSKK/IB Chinese). You can ask questions in Chinese or English, and the system will respond as a student learning Chinese, using simple Chinese with pinyin/English explanations when appropriate.",
        chatPlaceholder: "Please enter your question, e.g., Please introduce your weekend using HSK2 vocabulary...",
        send: "Send",
        clear: "Clear",
        footer: "© 2025 International Chinese Education Assistant 1.0 · Desktop & Mobile Compatible · Feedback: Course Group/Email",
        resultCount: "matching results"
      }
    };
    
    let lang = 'zh';
    const langBtn = document.getElementById('langToggle');
    
    function setLang(l){
      lang = l;
      const t = i18n[l];
      
      // Update all text content
      document.getElementById('heroTitle').textContent = t.heroTitle;
      document.getElementById('heroSubtitle').textContent = t.heroSubtitle;
      document.getElementById('heroDesc').textContent = t.heroDesc;
      
      // Update chips
      document.querySelectorAll('.chip').forEach((el, i) => {
        el.textContent = t.chips[i];
      });
      
      // Update search and filter
      document.getElementById('q').setAttribute('placeholder', t.searchPH);
      document.querySelector('#filter option[value="all"]').textContent = t.all;
      document.querySelector('#filter option[value="study"]').textContent = t.study;
      document.querySelector('#filter option[value="game"]').textContent = t.game;
      document.querySelector('#filter option[value="tool"]').textContent = t.tool;
      
      // Update card elements
      document.querySelectorAll('.go .hint').forEach(el => el.textContent = t.go);
      document.querySelectorAll('.cta').forEach(el => el.textContent = t.open);
      
      // Update buttons
      document.getElementById('browseAll').lastChild.textContent = ' ' + t.browse;
      document.querySelector('#themeToggle').lastChild.textContent = ' ' + t.theme;
      document.getElementById('langToggle').textContent = t.langToggle;
      
      // Update chat section
      document.getElementById('chatTitle').textContent = t.chatTitle;
      document.getElementById('chatDesc').innerHTML = t.chatDesc;
      document.getElementById('chatInput').setAttribute('placeholder', t.chatPlaceholder);
      document.querySelector('#chatSend').lastChild.textContent = ' ' + t.send;
      document.getElementById('chatClear').textContent = t.clear;
      
      // Update footer
      document.getElementById('footer').innerHTML = t.footer;
      
      // Update result count text if needed
      applyFilter();
      
      // Update HTML lang attribute
      document.documentElement.lang = l === 'zh' ? 'zh-CN' : 'en';
    }
    
    langBtn.addEventListener('click', () => {
      setLang(lang === 'zh' ? 'en' : 'zh');
    });

    // Initialize language
    setLang('zh');
  </script>

  <script>
  // ---------- DeepSeek Chat Companion (Hidden API config) ----------
  const DS_BASE  = "https://api.deepseek.com"; // fixed base
  const DS_MODEL = "deepseek-chat";            // fixed model
  const DS_KEY   = "sk-03543c891dbc4c2b84bf8eec9e8b0e89"; // Your API key

  const SYSTEM_PROMPT = "你是一个正在学习汉语的国际学生（与 HSK/HSKK/IB 中文课程对接）。请用简洁自然的中文进行对话，必要时附上拼音和简短英文解释，避免一次性给出过多信息，并鼓励继续交流。";
  const chatBox = document.getElementById('chatMessages');
  const chatForm = document.getElementById('chatForm');
  const chatInput = document.getElementById('chatInput');
  const clearBtn = document.getElementById('chatClear');

  function el(tag, attrs={}, children=[]){
    const n = document.createElement(tag);
    Object.entries(attrs).forEach(([k,v]) => {
      if(k==='class') n.className = v;
      else if(k==='html') n.innerHTML = v;
      else n.setAttribute(k,v);
    });
    children.forEach(c => n.appendChild(c));
    return n;
  }
  
  function bubble(role, text){
    const wrap = el('div', {class:'msg', style: 'margin:8px 0; display:flex; gap:10px; align-items:flex-start'});
    const icon = el('div', {class:'msg-ico', style:'width:28px;height:28px;border-radius:8px;display:grid;place-items:center;color:white;background:linear-gradient(135deg,var(--brand),var(--brand-2));flex:0 0 28px'});
    icon.innerHTML = role==='user' ? '<span style="font-weight:800">U</span>' : '<span style="font-weight:800">助</span>';
    const body = el('div', {class:'msg-body', style:'background:var(--surface);border:1px solid var(--line);border-radius:12px;padding:10px 12px;white-space:pre-wrap;word-wrap:break-word;max-width:100%'});
    body.textContent = text;
    wrap.appendChild(icon); wrap.appendChild(body);
    chatBox.appendChild(wrap);
    chatBox.scrollTop = chatBox.scrollHeight;
  }

  let history = [{ role:'system', content: SYSTEM_PROMPT }];
  bubble('assistant','你好！我是"汉语学习者"角色的学伴。可以用 HSK 词汇聊聊：先做自我介绍吗？(wǒ shì ...; wǒ xǐhuan ...)');

  chatForm.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const content = (chatInput.value || '').trim();
    if(!content) return;
    bubble('user', content);
    chatInput.value = '';

    const thinking = el('div',{class:'msg msg-thinking', style:'margin:8px 0;opacity:.75'},[
      el('div',{html: lang === 'zh' ? '正在思考…' : 'Thinking...', style:'padding:6px 8px;color:var(--muted)'})
    ]);
    chatBox.appendChild(thinking);
    chatBox.scrollTop = chatBox.scrollHeight;

    try{
      let replyText = '';
      if(DS_KEY && DS_KEY !== "your_api_key_here"){
        const url = DS_BASE.replace(/\/+$/,'') + '/v1/chat/completions';
        const payload = {
          model: DS_MODEL,
          messages: [...history, {role:'user', content}],
          temperature: 0.5,
          stream: false
        };
        const res = await fetch(url, {
          method:'POST',
          headers:{
            'Content-Type':'application/json',
            'Authorization': 'Bearer ' + DS_KEY
          },
          body: JSON.stringify(payload)
        });
        if(!res.ok){
          throw new Error('HTTP ' + res.status + ' ' + (await res.text()).slice(0,200));
        }
        const data = await res.json();
        replyText = (data.choices && data.choices[0] && data.choices[0].message && data.choices[0].message.content) || (lang === 'zh' ? '（未获取到回复内容）' : '(No response content obtained)');
      }else{
        // Local teaching demo fallback
        replyText = lang === 'zh' 
          ? "（演示模式）好的！请用 HSK2 词汇介绍你的周末：例如\"周末我去公园跑步，还和朋友一起吃中国菜\"。如果需要，我可以给你拼音和英语小提示。" 
          : "(Demo mode) Okay! Please introduce your weekend using HSK2 vocabulary: for example, \"On weekends I go to the park to run, and also eat Chinese food with friends.\" If needed, I can give you pinyin and English hints.";
      }
      thinking.remove();
      bubble('assistant', replyText);
      history.push({role:'user', content});
      history.push({role:'assistant', content: replyText});
    }catch(err){
      thinking.remove();
      bubble('assistant', lang === 'zh' 
        ? '抱歉，调用 DeepSeek 失败：' + err.message + '。请在 HTML 中替换 DS_KEY，或继续使用演示模式。' 
        : 'Sorry, calling DeepSeek failed: ' + err.message + '. Please replace DS_KEY in HTML, or continue using demo mode.');
    }
  });

  clearBtn.addEventListener('click', ()=>{
    chatBox.innerHTML = '';
    history = [{ role:'system', content: SYSTEM_PROMPT }];
    bubble('assistant', lang === 'zh' 
      ? '对话已清空。我们重新开始吧！请用一句话介绍你今天的计划～' 
      : 'Conversation cleared. Let\'s start over! Please introduce your plan for today in one sentence~');
  });
</script>

</body>
</html>
